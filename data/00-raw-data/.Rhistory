summary(lm(y~b+b^2))
summary(lm(y~a+I(a^2)))
summary(lm(y~b+I(b^2)))
a = c(1,2,3)
var(a)
b = a^2
var(b)
?t
qt(0.3,16)
qt(0.1,1)
qt(0.15,16)
knitr::opts_chunk$set(include = TRUE)  # TRUE for solution; FALSE for questions set
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.height = 5, fig.width = 7, out.width = '60%', fig.align = "center")
knitr::opts_chunk$set(fig.pos = "H", out.extra = "")
options(width = 100)
wage=readRDS("ck94.RDS")
library(tidyverse)
wage%>%group_by(state)%>%
summarize(BurgerKing=sum(chain==1),
KFC=sum(chain==2),
RoyRogers=sum(chain==3),
Wendys=sum(chain==4),
co_owned=sum(co_owned==1),
total_chain=n())
#wage%>%group_by(state)%>%
#  summarize(fraction_BurgerKing=sum(chain==1)/sum(chain))
wage=readRDS("ck94.RDS")
library(tidyverse)
wage%>%group_by(state)%>%
summarize(BurgerKing=sum(chain==1),
KFC=sum(chain==2),
RoyRogers=sum(chain==3),
Wendys=sum(chain==4),
co_owned=sum(co_owned==1),
total_chain=n())
wage%>%group_by(state)%>%
summarize(fraction_BurgerKing=sum(chain==1)/n())
wage%>%group_by(state)%>%
summarize(BurgerKing=sum(chain==1),
KFC=sum(chain==2),
RoyRogers=sum(chain==3),
Wendys=sum(chain==4),
co_owned=sum(co_owned==1),
total_chain=n())
wage%>%group_by(state)%>%
summarize(fraction_BurgerKing=sum(chain==1)/n(),
fraction_KFC=sum(chain==2)/n(),
fraction_RoyRogers=sum(chain==3)/n(),
fraction_Wendys=sum(chain==3)/n(),
fraction_coowned=sum(co_owned==1)/n())
wage%>%group_by(state)%>%
summarize(fraction_BurgerKing=sum(chain==1)/n(),
fraction_KFC=sum(chain==2)/n(),
fraction_RoyRogers=sum(chain==3)/n(),
fraction_Wendys=sum(chain==4)/n(),
fraction_coowned=sum(co_owned==1)/n())
wage$TREAT=ifelse(wage$wage_st<=5,1,0)
wage%>%filter(wage$state==1)%>%group_by(TREAT)%>%summarize(wage1=mean(wage_st,na.rm=T),
wage2=mean(wage_st2,na.rm=T))
DiD1=(5.0625-4.459834)-(5.111268-5.114932)
DiD1
DiD1
DiD1=(5.0625-4.459834)-(5.111268-5.114932)
wage$TREAT=ifelse(wage$wage_st<=5,1,0)
wage%>%filter(wage$state==1)%>%group_by(TREAT)%>%summarize(wage1=mean(wage_st,na.rm=T),
wage2=mean(wage_st2,na.rm=T))
DiD1=(5.0763-4.5448)-(5.1378-5.2996)
DiD1
wage%>%filter(wage$state==1)%>%group_by(TREAT)%>%
summarize(emply1=mean(fte,na.rm=T),
emply2=mean(fte2,na.rm=T))
DiD2=(17.3216-16.6140)-(17.0556-21.8241)
DiD2
wage%>%filter(wage$state==0)%>%group_by(TREAT)%>%summarize(wage1=mean(wage_st,na.rm=T),
wage2=mean(wage_st2,na.rm=T))
DiD3=(4.526444-4.430577)-(4.8-5.0625)
wage%>%filter(wage$state==0)%>%group_by(TREAT)%>%summarize(wage1=mean(wage_st,na.rm=T),
wage2=mean(wage_st2,na.rm=T))
DiD3=(4.6030-4.5888)-(4.875-5.375)
DiD3
wage%>%filter(wage$state==0)%>%group_by(TREAT)%>%
summarize(emply1=mean(fte,na.rm=T),
emply2=mean(fte2,na.rm=T))
DiD4=(17.675-20.2535)-(19.625-16.0625)
DiD4
crime=crime%>%mutate(dint=time_ind*institu1)
crime=readRDS("DS04.RDS")
crime_pre=crime[crime$mes%in%c(4,5,6,7),]
t.test(totrob~institu1,data=crime_pre)
crime_post=crime[crime$mes%in%c(8,9,10,11,12),]
t.test(totrob~institu1,data=crime_post)
crime$time_ind=ifelse(crime$mes%in%c(4,5,6,7), 0, 1)
crime%>%group_by(institu1, time_ind)%>%
summarize(crime_rate = mean(totrob))
(0.03513514-0.0895273)-(0.10470799-0.08157032)
crime=crime%>%mutate(dint=time_ind*institu1)
reg3=lm(totrob~time_ind+institu1+dint,data=crime)
summary(reg3)
reg3=lm(totrob~time_ind+institu1+dint,cluster=~observ,data=crime)
summary(reg3)
crime=crime%>%mutate(dint=time_ind*institu1)
reg3=lm(totrob~time_ind+institu1+dint,cluster=~observ,data=crime)
summary(reg3)
crime%>%filter(time_ind==1, institu1==0)%>%summarize(mean(totrob))
-0.0775/0.1047*100
-74.02101/223
library(ggthemes)
data_plot=crime%>%group_by(institu1, mes)%>%summarize(car_theft=mean(totrob))
data_plot=data_plot%>%mutate(treat=ifelse(institu1==1, "Treatment", "Control"))
plot<-ggplot()+
geom_line(data=data_plot,
aes(x=mes, y=car_theft, col=treat),
size=1.4)+
scale_color_fivethirtyeight("Treatment Status")+
theme_fivethirtyeight()+
labs(x = "Month", y="Average Car theft")+
geom_vline(xintercept = 7, linetype="dashed")+
theme(axis.text=element_text(size=12),
axis.title=element_text(size=12,face="bold"))
plot
pt(2.2,99)
1-pt(2.2,99)
?chi
?xsquare
?x2
qchisq(0.965, 13)
qchisq(0.035, 13)
13*.45/qchisq(0.035, 13)
13*.45/qchisq(0.965, 13)
sqrt(13*(.45^2)/qchisq(0.965, 13))
sqrt(13*(.45^2)/qchisq(0.035, 13))
15.3+c(1,-1)*qt(0.045,9)*(.25/sqrt(10))
4500000^2*(0.2/0.6)+5000000^2*(0.15/0.6)+5500000^2*(0.25/0.6)-5041667^2
0.1*3500000+0.3*4000000+0.2*4500000+0.15*5000000+0.25*5500000-0.1*3100000-0.3*3200000-0.2*3300000-0.15*3400000-0.25*3500000
0.1*3500000+0.3*4000000+0.2*4500000+0.15*5000000+0.25*5500000
0.1*3500000^2+0.3*4000000^2+0.2*4500000^2+0.15*5000000^2+0.25*5500000^2-4575000^2
4.56875e+11+18275000000
87/120
ï¼ˆ0.725-0.6)/sqrt(0.6*0.4/120)
(0.725-0.6)/sqrt(0.6*0.4/120)
55/80
75/100
0.75-0.6875
1-0.75-0.6875
1-0.75+0.6875
1-0.6875
sqrt((0.6875*0.3125)/80+(0.75*0.25)/100)
1.96+sqrt((0.6875*0.3125)/80+(0.75*0.25)/100)
1.96*sqrt((0.6875*0.3125)/80+(0.75*0.25)/100)
0.625-0.1324
0.625+0.1324
0.0625+0.1324
0.0625-0.1324
0.0625/0.0675
pnorm(0.9259)
2*(1-0.8228)
qt(0.0005,19)
qt(0.005,19)
((12.3^2/8)+(15.2^2/13))^2
((12.3^2/8)+(15.1^2/13))^2
1/7*((12.3^2/8)^2
1/7*((12.3^2/8)^2)+1/12*((15.1^2/13)^2)
1/7*((12.3^2/8)^2))+1/12*((15.1^2/13)^2)
(1/7)*((12.3^2/8)^2)+(1/12)*((15.1^2/13)^2)
1328.638/76.72615
qt(0.005,17)
qt(1.181)
qt(1.181,19)
pnorm(1.181,19)
qt(0.025,99)
pnorm(-1.01)
pnorm(-1.5)
0.22+pnorm(0.71)*sqrt(0.2*0.8/200)
pnorm(0.05)
pt(0.01,24)
56-pt(0.01,24)*8/sqrt(25)
56+pt(0.01,24)*8/sqrt(25)
56+qnorm(0.01)*8/sqrt(25)
?pt
qnorm(0.01)
pt(0.01,24)
qt(0.01,24)
pnorm(1.4)
qnorm(0.025)
qnorm(0.025)
pnorm(1.12)
qnorm(0.05)
pnorm(-1.822)
pt(0.7,9)
chisq.test(3)
chisq.test(3,0.016)
pchisq(0.016,3)
pchisq(6.5,3)
pchisq(10.42,4)
qchisq(10.42,4)
?dbinom
library(ggplot2)
library(MASS)
prof_evals = read.csv("Prof_Evals.csv")
View(prof_evals)
prof_evals = read.csv("Prof_Evals.csv")
nrow(prof_evals)
ncol(prof_evals)
names(prof_evals)
prof_model = lm(score~bty_avg, data = prof_evals)
summary(prof_model)
predict(prof_evals, newdata = data.frame(bty_avg = c(6.25:9.5)))
predict(prof_evals, newdata = data.frame(bty_avg = c(6.25:9.5)),
interval = c("prediction", level = 0.9))
predict(prof_evals, newdata = data.frame(bty_avg = c(6.25,9.5)),
interval = c("prediction", level = 0.9))
predict(prof_evals, newdata = data.frame(bty_avg = c(6.25,9.5)),
interval = c("prediction", level = 0.9))
predict(prof_evals, data.frame(bty_avg = c(6.25,9.5)),
interval = c("prediction", level = 0.9))
newbty = data.frame(bty_avg = c(6.25,9.5))
predict(prof_evals, newdata = newbty),
predict(prof_evals, newdata = newbty,
interval = c("prediction", level = 0.9))
predict(prof_evals, newdata = newbty,
interval = c("prediction"), level = 0.9))
predict(prof_evals, newdata = newbty,
interval = c("prediction"), level = 0.9)
predict(prof_evals, newdata = newbty,
interval = c("confidence"), level = 0.9)
predict(prof_evals, newdata = newbty)
predict(prof_evals, newbty)
?predict
?predict
predict.lm(prof_evals, newbty)
predict.lm(prof_evals, bty_avg = c(6.25,9.5))
View(newbty)
newbty = data.frame(bty_avg = c(6.25,9.5),score)
newbty = data.frame(bty_avg = c(6.25,9.5), score)
View(newbty)
predict.lm(prof_evals, newbty)
newbty = data.frame(bty_avg = c(6.25,9.5))
predict(prof_model, newdata = newbty)
predict(prof_model, newdata = newbty, interval = ("prediction") )
predict(prof_model, newdata = newbty, interval = ("confidence") )
newbty = data.frame(bty_avg = c(6.25,9.5))
predict(prof_model, newdata = newbty, interval = ("confidence") )
predict(prof_model, newdata = newbty)
confint(prof_model, level = 0.87)
View(crime)
predict(prof_model, newdata = data.frame(bty_avg = c(3,7)),
interval = ("prediction"), level = 0.95)
predict(prof_model, newdata = bty_avg),
predict(prof_model, newdata = data.frame(bty_avg)),
predict(prof_model, newdata = data.frame(bty_avg),
interval = ("confidence"), level = 0.95)
predict(prof_model, newdata = prof_evals,
interval = ("confidence"), level = 0.95)
summary(coef(prof_model))
newbty = data.frame(bty_avg = c(6.25,9.5))
predict(prof_model, newdata = newbty)
summary(coef(prof_model))
summary(coef(prof_model)[2])
newbty = data.frame(bty_avg = c(6.25,9.5))
predict(prof_model, newdata = newbty)
prof_model$coefficients
prof_model$coefficients[1]
((3.71225+4.78145)/2-prof_model$coefficients[1])/prof_model$coefficients[2]
x_bar = mean(prof_evals$bty_avg)
y_bar = mean(prof_evals$score)
S_xx = sum((prof_evals$bty_avg - mean(prof_evals$bty_avg))^2)
S_yy = sum((prof_evals$bty_avg - mean(prof_evals$bty_avg))*(prof_evals$score - mean(prof_evals$score)))
x_bar = mean(prof_evals$bty_avg)
y_bar = mean(prof_evals$score)
S_xx = sum((prof_evals$bty_avg - mean(prof_evals$bty_avg))^2)
S_xy = sum((prof_evals$bty_avg - mean(prof_evals$bty_avg))*(prof_evals$score - mean(prof_evals$score)))
beta1 = S_xy/S_xx
beta0= y_bar-beta1*x_bar
beta1 = S_xy/S_xx
beta0= y_bar-beta1*x_bar
head(resid(prof_model))
(1/(nrow(prof_evals)-2))*sum((resid(prof_model))^2)
sqrt( 0.2860483)
sqrt((1/(nrow(prof_evals)-2))*sum((resid(prof_model))^2))
se = sqrt((1/(nrow(prof_evals)-2))*sum((resid(prof_model))^2))
install.packages("pwr")
b1_sd = sqrt(se/S_xx)
b0_sd = sqrt(se*((1/nrow(prof_evals))+x_bar^2/S_xx))
se/S_xx
?cats
library(MASS)
View(cats)
cat_model = lm(Hwt~Bwt, data = cats)
library(MASS)
cat_model = lm(Hwt~Bwt, data = cats)
summary(cat_model)
sd(cat_model)
se(cat_model)
names(cat_model)
df.residual(cat_model)
residuals(cat_model)
fitted.values(cat_model)
qr(cat_model)
b1_sd = se/sqrt(S_xx)
b0_sd = sqrt(se*((1/nrow(prof_evals))+x_bar^2/S_xx))
b1_sd = se/sqrt(S_xx)
b0_sd = se*sqrt((1/nrow(prof_evals)+x_bar^2/S_xx))
test_stat = (4.0341 - 3.25)/0.2505
?tdistribution
??tdist
?ptnorm
??pt
?qt
pt(-2.764,10)
1-pt(-2.764,10)
pt(-2.764,10)
pt(-2.764,10)*2
p_value = 2*(1-pt(test_stat, nrow(cats)))
pt(-3.13, nrow(cats))*2
confint(coef(cat_model)[1], level = 0.9)
coef(cat_model)[1]
coef(cat_model)[2]
confint(coef(cat_model)[2], level = 0.9)
confint(cat_model, level = 0.9)
confint(coef(cat_model)[2], level = 0.9)
confint(cat_model, level = 0.9)
confint(cat_model, level = 0.99)
predict(cat_model, newdata = data.frame(Bwt = c(2.1, 2.8)),
interval = ("confidence"), level = 0.99)
mean(cats$Bwt)
predict(cat_model, newdata = data.frame(Bwt = 4.2),
interval = ("prediction"), level = 0.99)
plot(prof_model)
plot(cat_model)
coef(cat_model)[0]
coef(cat_model)[1]
coef(cat_model)[2]
View(prof_evals)
summary(prof_evals$bty_avg)
summary(prof_evals$bty_avg)
summary(cat_model$Bwt)
summary(cats$Bwt)
library(ggplot2)
library(MASS)
prof_evals = read.csv("Prof_Evals.csv")
View(prof_evals)
prof_model = lm(score~bty_avg+age+cls_students+cls_perc_eval, data = prof_evals)
summary(prof_model)
coef(prof_model)[2]
predict(prof_model, newdata = data.frame(bty_avg = 6.25, age = 52, cls_students = 61, cls_perc_eval = 83))
predict(prof_model, newdata = data.frame(bty_avg = 6.25, age = 52, cls_students = 61, cls_perc_eval = 83))
predict(prof_model, newdata = data.frame(bty_avg = 9.5, age = 34, cls_students = 270, cls_perc_eval = 96))
4.6 - 4.310864
3.7 - 4.710826
predict(prof_model, newdata = data.frame(bty_avg = 9.5, age = 34, cls_students = 270, cls_perc_eval = 96),
interval = ("confidence"), level = 0.85)
predict(prof_model, newdata = data.frame(bty_avg = 6.25, age = 52, cls_students = 61, cls_perc_eval = 83),
interval = ("prediction"), level = 0.75)
confint(prof_model, level = 0.8)
confint(prof_model, level = 0.95)
confint(prof_model, level = 0.8)
library(tidyverse)
skeptic = read_csv("skeptic.csv")
names(skeptic)
skeptic_model = lm(y~x, data = skeptic)
coef(skeptic_model)[2]
skeptic = read.csv("skeptic.csv")
names(skeptic)
skeptic_model = lm(y~x, data = skeptic)
coef(skeptic_model)[2]
summary(skeptic_model)
?pt
teststat=(coef(skeptic_model)[2]-mean(beta1hat))*sqrt(reps)/sd(beta1hat)
library(ggplot2)
library(MASS)
prof_evals = read.csv("Prof_Evals.csv")
prof_model = lm(score~bty_avg+age+cls_students+cls_perc_eval, data = prof_evals)
summary(prof_model)
predict(prof_model, newdata = data.frame(bty_avg = 6.25, age = 52, cls_students = 61, cls_perc_eval = 83))
predict(prof_model, newdata = data.frame(bty_avg = 9.5, age = 34, cls_students = 270, cls_perc_eval = 96))
4.6 - 4.310864
3.7 - 4.710826
predict(prof_model, newdata = data.frame(bty_avg = 9.5, age = 34, cls_students = 270, cls_perc_eval = 96),
interval = ("confidence"), level = 0.85)
predict(prof_model, newdata = data.frame(bty_avg = 6.25, age = 52, cls_students = 61, cls_perc_eval = 83),
interval = ("prediction"), level = 0.75)
confint(prof_model, level = 0.8)
confint(prof_model, level = 0.87)
null_prof_model = lm(score~1, data = prof_evals)
summary(null_prof_model)
mean(prof_evals$score, na.rm = T)
anova(null_prof_model, prof_model)
birthday = 20000511
set.seed(birthday)
n = 125
x = runif(n, -2, 2)
reps = 2500
beta0 = 4
beta1 = 0
sigma = 6
beta0hat = vector(length = reps)
beta1hat = vector(length = reps)
for(i in 1:reps){
epsilon = rnorm(n, 0, sigma)
y = beta0 + beta1 * x + epsilon
mymodel = lm(y ~ x)
beta0hat[i] = coef(mymodel)[1] ## change this line of code
beta1hat[i] = coef(mymodel)[2] ## change this line of code
}
ests = data.frame(cbind(beta0hat, beta1hat))
hist(beta1hat)
skeptic = read.csv("skeptic.csv")
names(skeptic)
skeptic_model = lm(y~x, data = skeptic)
coef(skeptic_model)[2]
teststat=(coef(skeptic_model)[2]-mean(beta1hat))*sqrt(reps)/sd(beta1hat)
pt(teststat, reps-1)
teststat=(coef(skeptic_model)[2]-mean(beta1hat))*sqrt(reps)/sd(beta1hat)
1-pt(teststat, reps-1)
teststat=(coef(skeptic_model)[2]-mean(beta1hat))*sqrt(reps)/sd(beta1hat)
1-pt(teststat, reps-1)*2
teststat=(coef(skeptic_model)[2]-mean(beta1hat))*sqrt(reps)/sd(beta1hat)
(1-pt(teststat, reps-1))*2
mean(beta1hat)
teststat=(coef(skeptic_model)[2]-mean(beta1hat))/sd(beta1hat)
(1-pt(teststat, reps-1))*2
teststat=(coef(skeptic_model)[2]-mean(beta1hat))/(sd(beta1hat)/sqrt(reps))
(1-pt(teststat, reps-1))*2
qt(0.975, reps-1)
qt(0.975, reps-1)*sd(beta1hat)/sqrt(reps)+mean(beta1hat)
mean(beta1hat)+c(1,-1)*qt(0.975,reps-1)*sd(beta1hat)/sqrt(reps)
mean(beta1hat)+c(1,-1)*qt(0.975,reps-1)*sd(beta1hat)
teststat=(coef(skeptic_model)[2]-mean(beta1hat))/sd(beta1hat)
(1-pt(teststat, reps-1))*2
library(ggplot2)
df1 = data.frame("Mean"=c(4.75,3.88,24.63,22.75), "Sd"=c(2.44,2.82,8.54,7.85), "Sex"=c("Female", "Male", "Female", "Male"), "Handle"=c("Handled", "Handled", "Not Handled", "Not Handled"))
View(df1)
ggplot(df1, aes(x=Handle, y=Mean, fill=Sex)) +
geom_bar(stat="identity", color="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=Mean-Sd, ymax=Mean+Sd), width=.2,
position=position_dodge(.9)) +
labs(title="", x="", y = "")+
theme_classic()
ggplot(df1, aes(x=Handle, y=Mean, fill=Sex)) +
geom_bar(stat="identity", color="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=Mean-Sd, ymax=Mean+Sd), width=.2,
position=position_dodge(.9)) +
labs(title="Time spent (seconds) in the open arms vs. Handling", y = "mean")+
theme_classic()
df2 = data.frame("Mean"=c(3.75,3.75,4.13,3.25), "Sd"=c(0.75,0.65,0.69,0.59), "Sex"=c("Female", "Male", "Female", "Male"), "Handle"=c("Handled", "Handled", "Not Handled", "Not Handled"))
View(df2)
df2 = data.frame("Mean"=c(3.75,3.75,4.13,3.25), "Sd"=c(0.75,0.65,0.69,0.59), "Sex"=c("Female", "Male", "Female", "Male"), "Handle"=c("Handled", "Handled", "Not Handled", "Not Handled"))
ggplot(df2, aes(x=Handle, y=Mean, fill=Sex)) +
geom_bar(stat="identity", color="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=Mean-Sd, ymax=Mean+Sd), width=.2,
position=position_dodge(.9)) +
labs(title="Number of entries into the closed arms vs. Handling", y = "mean")+
theme_classic()
df3 = data.frame("Mean"=c(0.38,0.38,1.25,1.88), "Sd"=c(0.18,0.26,0.41,0.64), "Sex"=c("Female", "Male", "Female", "Male"), "Handle"=c("Handled", "Handled", "Not Handled", "Not Handled"))
View(df3)
ggplot(df3, aes(x=Handle, y=Mean, fill=Sex)) +
geom_bar(stat="identity", color="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=Mean-Sd, ymax=Mean+Sd), width=.2,
position=position_dodge(.9)) +
labs(title="Number of entries into the open arms vs. Handling", y = "mean")+
theme_classic()
16/30-(12/30)^2
2/15+2/(15*2^2)
1/5
1/6
15*4
2/60
2/60+2/15
2/15+2/60
2/15+1/60
2/15+1/30
1-1/15*(e^(-10/15)
1-1/15*(e^(-10/15)
1-1/15*e^(-10/15)
1-1/15*exp(-10/15)
pnorm(-1.87)
pnorm(-1.86667)
pnorm(-1.866)
pnorm(-28/15)
pnorm(-1.86)
28/15
15*0.675
15*0.675+56
1-pnorm(0.18)
1-pnorm(0.18)
pnorm(-0.37)
pnorm(-1/sqrt(7.2))
5/sqrt(625)
1-pnorm(0.2)
pnorm(-0.2)
pnorm(-10/sqrt(74))
5*150+5*140
25*(7^2+25)
50/sqrt(1850)
pnorm(1.1624)
pnorm(-1.16)
4*25+100*36+40*0.5*5*6
4*25+100*36-40*0.5*5*6
15^3
5^3*3^3
dim(data)
data = readRDS('rand_spend.RDS')
setwd("~/anly-501-project-liumingqian0511/data/00-raw-data")
data = readRDS('rand_spend.RDS')
dim(data)
